<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微服务探索与实践（三） | Zhu Zhaohua</title>
    <meta name="description" content="">
    <link rel="icon" href="/img/logo.jpeg">
    
    <link rel="preload" href="/assets/css/0.styles.a936f6f1.css" as="style"><link rel="preload" href="/assets/js/app.0d82a377.js" as="script"><link rel="preload" href="/assets/js/8.a5946d57.js" as="script"><link rel="preload" href="/assets/js/21.b20bdff7.js" as="script"><link rel="prefetch" href="/assets/js/10.14a4f126.js"><link rel="prefetch" href="/assets/js/11.2993392d.js"><link rel="prefetch" href="/assets/js/12.002c1f44.js"><link rel="prefetch" href="/assets/js/13.842be568.js"><link rel="prefetch" href="/assets/js/14.3a2e76f1.js"><link rel="prefetch" href="/assets/js/15.5437f5a0.js"><link rel="prefetch" href="/assets/js/16.c0a1c580.js"><link rel="prefetch" href="/assets/js/17.c0880455.js"><link rel="prefetch" href="/assets/js/18.c1b334fb.js"><link rel="prefetch" href="/assets/js/19.2295615c.js"><link rel="prefetch" href="/assets/js/2.12226995.js"><link rel="prefetch" href="/assets/js/20.ad17e7cd.js"><link rel="prefetch" href="/assets/js/22.fdd83b9e.js"><link rel="prefetch" href="/assets/js/23.40ea8278.js"><link rel="prefetch" href="/assets/js/24.c4daf250.js"><link rel="prefetch" href="/assets/js/25.e5f4ff8b.js"><link rel="prefetch" href="/assets/js/26.69714f88.js"><link rel="prefetch" href="/assets/js/27.661aefec.js"><link rel="prefetch" href="/assets/js/3.1db7d2c3.js"><link rel="prefetch" href="/assets/js/4.810532ad.js"><link rel="prefetch" href="/assets/js/5.5d2b6eba.js"><link rel="prefetch" href="/assets/js/6.4f7f1c8b.js"><link rel="prefetch" href="/assets/js/7.299ef908.js"><link rel="prefetch" href="/assets/js/9.17470fb0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a936f6f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpeg" alt="Zhu Zhaohua" class="logo"> <span class="site-name can-hide">Zhu Zhaohua</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/timeLine/" class="nav-link">时间线</a></div><div class="nav-item"><a href="/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/ponder/" class="nav-link">思考</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/cbc58f855e75" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/zhuzhaohua" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/kobuta" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <div class="can-hide" style="margin-left:20px;margin-right:20px;">
   音乐
  <div role="switch" class="el-switch"><input type="checkbox" name="" true-value="true" class="el-switch__input"><!----><span class="el-switch__core" style="width:40px;"></span><!----></div> <audio loop="loop"><source src="/assets/media/yishengyouni.a7e82e2b.mp3" type="audio/mpeg"></audio></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/timeLine/" class="nav-link">时间线</a></div><div class="nav-item"><a href="/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/ponder/" class="nav-link">思考</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/cbc58f855e75" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/zhuzhaohua" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/kobuta" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>微服务探索与实践（三）</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/technology/java/sc_03.html#分布式与微服务" class="sidebar-link">分布式与微服务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/technology/java/sc_03.html#技术选型——前端" class="sidebar-link">技术选型——前端</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/technology/java/sc_03.html#技术选型——后台" class="sidebar-link">技术选型——后台</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/technology/java/sc_03.html#架构图" class="sidebar-link">架构图</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/technology/java/sc_03.html#服务拆分" class="sidebar-link">服务拆分</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technology/java/sc_03.html#系统模块" class="sidebar-link">系统模块</a></li><li class="sidebar-sub-header"><a href="/technology/java/sc_03.html#核心模块群" class="sidebar-link">核心模块群</a></li><li class="sidebar-sub-header"><a href="/technology/java/sc_03.html#业务模块群" class="sidebar-link">业务模块群</a></li></ul></li><li><a href="/technology/java/sc_03.html#数据模型" class="sidebar-link">数据模型</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p>本章节我们做一个总体的梳理以及技术选型。</p> <h2 id="分布式与微服务"><a href="#分布式与微服务" aria-hidden="true" class="header-anchor">#</a> 分布式与微服务</h2> <p>首先要区分两个概念：</p> <ul><li>分布式架构
是运维概念。比如我们把一套完整的服务，分成很多模块，部署在不同的服务器上，或者我们把服务复制N份，部署在不同的服务器上做成高可用的集群。分布式所关注的是部署方式。</li> <li>微服务架构
是开发方式，我们把一套完整的服务按照业务拆分成很多个小服务，彼此之间的通信是跨进程的。</li></ul> <p>微服务架构不一定是分布式的，因为我们可以把所有内容部署在一台服务器上，而分布式也不一定采用微服务架构，比如集群部署。当然，越来越多的人把它们放在一起说，是因为二者的组合已经成为了行业内的最佳实践，是一种默许。</p> <p><strong>微服务，是为了扩展；
分布式，是为了存续</strong>。</p> <p>如何让一系列漂浮在网络中的应用高效的协调工作起来，而且在危急时刻不至于同归于尽，是这门技术的难点所在。</p> <h2 id="技术选型——前端"><a href="#技术选型——前端" aria-hidden="true" class="header-anchor">#</a> 技术选型——前端</h2> <p>前端领域，曾经一统江湖的jQuery+Bootstrap组合，在此就不做考虑了，毕竟更新更快的生产工具已经出现。现在来说是大前端技术的时代，react、angular、vue三分天下。至于三大框架哪个更好的争辩，读者可以自行去知乎，那里吵的比较厉害。</p> <p>这三大框架，笔者都略有涉猎，因为是做后台出身，所以在刚开始学习前端的时候，更钟情于angular，它的依赖注入思想，typescript的强类型，都非常亲切，但奈何angular在国内一直都是不温不火，其热度远不及vue和react。这里说的angular，不是angularJS，angular是一个大而全的集成框架，解决的是mvc的问题，而angularJS和vue、react一样，本身来说只是一个js库，解决的是mvc中的视图层的问题，三者可以脱离其自有的生态，应用在任何前端项目中。举例来说，笔者曾在基于backbone + requireJS + jQuery + bootstrap的项目中使用vue+element开发个别模块。vue、react是与任何前端框架都是松耦合的，可以自由的按需组合开发，而angular，大而全，技术比较锁定，这可能是它在国内水土不服的原因吧。再看react，其生态是最完善，热度最高，但对于jsx这种js与html的混搭，笔者愚钝，真的是难以适应。笔者最后选择对vue进行更深入的学习，vue在国内的热度也是极高的，社区支持非常丰富，学习曲线平缓，上手简单。笔者个人网站就是使用基于vue的vuepress搭建的：<a href="https://zhuzhaohua.com" target="_blank" rel="noopener noreferrer">zhuzhaohua.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>对于三大框架哪个更好，笔者无法给出的答案，喜好因人而异，而且作为十八线程序员，笔者实在是没有什么发言权。网上的支持者们、粉丝们会彼此攻击，可能是因为他们对各自的领域都倾注了心血，但对于笔者而言，即便是牛B上天的框架，也是只是个轮子。</p> <p>笔者使用vue生态。脚手架模板使用<a href="https://github.com/PanJiaChen/vue-element-admin" target="_blank" rel="noopener noreferrer">https://github.com/PanJiaChen/vue-element-admin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="技术选型——后台"><a href="#技术选型——后台" aria-hidden="true" class="header-anchor">#</a> 技术选型——后台</h2> <ul><li>整体解决方案：spring cloud 全家桶</li> <li>服务层：spring boot
<ul><li>持久层：jpa（hibernate）</li> <li>数据库: mysql</li> <li>缓存：redis</li></ul></li></ul> <p>后台其实可选的不是特别多，行业内比较普及的解决方案，也就数spring cloud和dubbo了。二者其实所处领域是略有不同的。spring cloud是工具包，解决的是服务治理、远程调用、集群、负载均衡、服务监控等，一整套的微服务解决方案；而dubbo专注于解决远程调用的问题。二者并不排斥，我们可以在spring cloud项目中的某一个业务模块，使用dubbo。spring cloud基于rest实现远程调用，dubbo是RPC方式。基于rest的话，通用性会更强，但性能明显没有RPC好，建议如果是系统内部调用、或者性能要求比较高的话，使用RPC，如果需要对外暴露服务，尽量使用rest。</p> <h2 id="架构图"><a href="#架构图" aria-hidden="true" class="header-anchor">#</a> 架构图</h2> <p>制作中</p> <h2 id="服务拆分"><a href="#服务拆分" aria-hidden="true" class="header-anchor">#</a> 服务拆分</h2> <h3 id="系统模块"><a href="#系统模块" aria-hidden="true" class="header-anchor">#</a> 系统模块</h3> <ul><li><strong>用户模块</strong>
外部模块，应作为单点登录，是所有系统的入口</li> <li><strong>对象模块</strong>
外部模块，获取业务上所需的保险人、客户、系统用户等对象的信息</li> <li><strong>核心模块群</strong>
收付费系统的中心模块，包括结算单模块、任务模块、凭证模块、支付模块等</li> <li><strong>业务模块群</strong>
保费、赔款、手续费等按照不同收付费类型确立的不同模块</li></ul> <h3 id="核心模块群"><a href="#核心模块群" aria-hidden="true" class="header-anchor">#</a> 核心模块群</h3> <p>业务模块-&gt;结算单模块-&gt;凭证模块-&gt;支付模块</p> <ul><li><strong>业务接口模块</strong>
业务数据、应收应付数据来源、系统对外接口</li> <li><strong>结算单模块</strong>
以业务模块数据生成结算单，以备结算</li> <li><strong>凭证模块</strong> <strong>最最核心</strong>  凭证生成规则、凭证配置、结算、挂账、红冲等核心操作。</li> <li><strong>支付模块</strong>
如果是付款操作，在生成凭证后，按照凭证进行线上执行转账汇款</li> <li><strong>任务模块</strong>
这里用户的操作，抽象为用户任务;
系统的定时任务，抽象为系统任务；
任务模块存在有三个目的：
<ul><li>自动化</li> <li>作为一个队列，同步转异步，以控制结算单模块、凭证模块的吞吐</li> <li>直观的显示，当前用户和系统工作的进度</li></ul></li> <li><strong>资金模块</strong>
银行、账号、货币等公共资源的配置</li></ul> <h3 id="业务模块群"><a href="#业务模块群" aria-hidden="true" class="header-anchor">#</a> 业务模块群</h3> <ul><li>保费模块</li> <li>赔款模块</li> <li>手续费模块</li> <li>共保模块</li> <li>再保模块</li> <li>发票模块</li></ul> <h2 id="数据模型"><a href="#数据模型" aria-hidden="true" class="header-anchor">#</a> 数据模型</h2> <ul><li><strong>用户模型</strong></li> <li><strong>权限模型</strong></li> <li><strong>对象模型</strong></li> <li><strong>交易模型</strong></li> <li><strong>业务模型</strong></li> <li><strong>应收应付模型</strong></li> <li><strong>结算单模型</strong></li> <li><strong>实收实付模型</strong></li> <li><strong>银企直连模型</strong></li> <li><strong>发票模型</strong></li> <li><strong>凭证模型</strong></li> <li><strong>任务模型</strong></li> <li><strong>银行模型</strong></li> <li><strong>账号模型</strong></li> <li><strong>货币模型</strong></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间: </span> <span class="time">2019-07-01</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/technology/java/sc_02.html" class="prev">上一页
        </a></span> <span class="next"><a href="/technology/java/sc_04.html">下一页
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.0d82a377.js" defer></script><script src="/assets/js/8.a5946d57.js" defer></script><script src="/assets/js/21.b20bdff7.js" defer></script>
  </body>
</html>
